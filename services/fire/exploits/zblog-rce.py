#!/usr/bin/env python
# -*- coding: utf-8 -*-

import sys
import hashlib
import time
import random

class Exploit():
    def __init__(self, author, challenge):
        self.challenge = challenge
        self.author = author

    def run(self, target):
        team = target['team']
        host = target['host']
        port = target['port']
        try:
            flag = self.exploit(host, port)
            return (True, flag)
        except Exception as e:
            return (False, repr(e))

    def exploit(self, host, port):
        if random.choice([True, False]):
            raise Exception("Connection timeout")
        else:
            return "flag{%s}" % hashlib.md5(str(int(time.time()/60/5))).hexdigest()
        
def main():
    exploit = Exploit("Wang Yihang", "oneshot")
    target = {
        "team":"PPP",
        "host":"192.168.1.1",
        "port":1337,
    }
    exploit.run(target)

if __name__ == "__main__":
    main()
